[toc]

## 汇编语言

### linux安装nasm环境

> 1. sudo apt-get install nasm
>
> 2. 创建.asm文件	
>
> 3. 64位
>
>    nasm -f elf64 -g -F stabs helloworld.asm -o helloworld.o // 编译
>
>    ld -o helloworld helloworld.o // 链接
>
>    32位
>
>    nasm -f elf -g -F stabs helloworld.asm -o helloworld.o
>
>    ld -m elf_i386 -o helloworld helloworld.o
>
> 4. 运行./hello

### 16位结构的cpu

> 概括地讲，一个16位的cpu具有一下几个方面的特征
>
> 1. 运算器（ALU）一次最多可以处理16为的数据
> 2. 寄存器的最大宽度为16位
> 3. 寄存器和运算器之间的通路是16位的

### 8086cpu给出物理地址的方法(物理地址 = 段地址 * 16 + 偏移地址)

> 8086有20位地址总线，可传送20位地址数据，寻址能力为1M，2^20*8bit(8086一个存储单元的容量为8bit) = 1M
>
> 8086内部为16位结构，它只能传送16位的地址，表现出的寻址能力只有64k
>
> 8086cpu采用一种在内部用两个16位地址合成的方法来形成一个20位的物理地址（通过地址加法器）
>
> ![](https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimages.cnblogs.com%2Fcnblogs_com%2Fvanie%2F201103%2F201103030220052921.jpg&refer=http%3A%2F%2Fimages.cnblogs.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1654155294&t=716088c10c40ea642801a286d43dae74)
>
> 地址加法器合成物理地址的方法：物理地址 = 段地址 * 16 + 偏移地址
>
> ![](https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F2018969-fd967f2e9eec4d5c.png&refer=http%3A%2F%2Fupload-images.jianshu.io&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1654155472&t=6030ee30500f5817e8328d1175eba410)
>
> - 物理地址 = 段地址 * 16 + 偏移地址 —— 本质含义
>
>   比喻：比如说学校、体育馆同在一条笔直的单行路上（学校位于路的起点0米处）
>
>   我在学校，要去图书馆，问我那里的地址，我可以用几种方式描述这个地址？
>
>   ————————————————————————————————
>   |																	|											|
>
>   0m（学校）												2000m（体育馆）				2826m(图书馆)
>
>   1) 从学校走2826m到图书馆，这2826m可以认为是图书馆的物理地址
>
>   2) 从学校走2000m到体育馆，从体育馆走826m到图书馆
>
>      第一个距离2000m是相对于起点的基础地址
>
>      第二个距离826m是将对于基础地址的偏移地址

### 寄存器概述

> 8086cpu有14个寄存器，它们的名称为：ax、bx、cx、dx、si、di、sp、bp、ip、cs、ss、ds、es、psw
>
> - 通用寄存器
>
>   8086cpu所有的寄存器都是16位的，可以存放两个字节
>
> 数据18
> 二进制表示10010
> 在寄存器ax中存储：
>
> | 15   | 14   | 13   | 12   | 11   | 10   | 9    | 8    | 7    | 6    | 5    | 4    | 3    | 2    | 1    | 0    |
> | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
> | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 1    | 0    | 0    | 1    | 0    |
>
> 一个16位寄存器能存储的最大的数值：2^16-1
>
> 8086上一代的cpu中的寄存器都是8位的，为保证兼容性，这四个寄存器都可以分为两个独立8位的寄存器使用
>
> ax可以分为ah和al
> bx可以分为bh和bl
> cx可以分为ch和cl
> dx可以分为dh和dl

### 几条汇编指令

> | 汇编指令   | 控制cpu完成的操作                  | 用高级语言的语法描述 |
> | ---------- | ---------------------------------- | -------------------- |
> | mov ax, 18 | 将18送入ax                         | ax = 18              |
> | mav ah, 78 | 将78送入ah                         | ah = 78              |
> | add ax, 8  | 将寄存器ax中的数值+8               | ax = ax + 8          |
> | mov ax, bx | 将寄存器bx中的数据送入ax寄存器     | ax = bx              |
> | add ax, bx | 将ax, bx中的内存相加，结果存在ax中 | ax = ax + bx         |
>
> add ax, bx // ax = 8226h, bx = 8226h
> ax = 044ch // 结果应该是1044ch，但一个寄存器只能存16位数据，所以这个1被进位了
>
> 





